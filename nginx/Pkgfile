# Description: HTTP server and mail proxy
# URL: http://nginx.net
# Maintainer: Lucas Hazel, lucas at die dot net dot au
# Depends on: zlib, libpcre, openssl

name=nginx
version=0.7.61
release=1
source=(http://sysoev.ru/nginx/$name-$version.tar.gz $name.rc)

build() {
    cd $name-$version
    ./configure --prefix=/etc/$name \
	--conf-path=/etc/$name/$name.conf \
	--pid-path=/var/run/$name.pid \
	--lock-path=/var/lock/$name.lock \
	--error-log-path=/var/log/$name/error.log \
	--http-log-path=/var/log/$name/access.log \
	--user=www \
	--group=www \
	--http-client-body-temp-path=/var/tmp/client_body_temp \
	--http-proxy-temp-path=/var/tmp/proxy_temp \
	--http-fastcgi-temp-path=/var/tmp/fastcgi_temp \
	--with-http_ssl_module \
	--with-mail \
	--with-mail_ssl_module \
	--with-pcre
    
    
    make
    make DESTDIR=$PKG install
    
    mkdir $PKG/usr
    mv $PKG/etc/nginx/sbin $PKG/usr
    rm -rf $PKG/var/run
    
    install -D -m 0755 $SRC/$name.rc $PKG/etc/rc.d/$name
}
